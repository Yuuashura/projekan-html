<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Detail Komik - Tema Gelap</title>
    <link rel="stylesheet" href="../css/header-footer.css" />
    <style>
      :root {
        --dark-navy: #0a192f;
        --navy: #112240;
        --light-navy: #233554;
        --lightest-navy: #303c55;
        --slate: #8892b0;
        --light-slate: #a8b2d1;
        --lightest-slate: #ccd6f6;
        --white: #e6f1ff;
        --accent: #64ffda;
      }

      
@keyframes inAnimation {
    from {
        opacity: 0;
        transform: translateY(30px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}


  main{
    min-height: 80vh;
  }


      .main-container {
        display: flex;
        max-width: 1200px;
        margin: 20px auto;
        background: var(--navy);
        box-shadow: 0 10px 30px -15px rgba(2, 12, 27, 0.7);
        border-radius: 8px;
        overflow: hidden;
      }


      .left-column {
        width: 33%;
        padding: 25px;
        border-right: 1px solid var(--lightest-navy);
      }

      .right-column {
        /* flex: 2; */
        width: 67%;
        padding: 25px;
      }

      .left-column,
      .right-column
      {
        animation: inAnimation 0.5s ease-in-out;
      }

      .thumbnail {
        width: 100%;
        max-width: 300px;
        border-radius: 8px;
        margin-bottom: 25px;
        border: 2px solid var(--lightest-navy);
      }

      .info-details-container {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .info-item {
        display: flex;
        flex-direction: column;
        padding: 10px;
        background-color: var(--light-navy);
        border-radius: 5px;
      }

      .info-item .label {
        font-weight: bold;
        color: var(--accent);
        font-size: 0.8em;
        margin-bottom: 4px;
      }

      .info-item .value {
        font-size: 1em;
        color: var(--lightest-slate);
      }

      h1,
      h2 {
        color: var(--white);
        border-bottom: 1px solid var(--lightest-navy);
        padding-bottom: 10px;
      }

      h3 {
        padding: 10px 0px;
      }

      h1 {
        font-size: 2.2em;
      }

      .genres {
        margin-bottom: 20px;
      }

      .genre-tag {
        display: inline-block;
        background-color: var(--accent);
        color: var(--dark-navy);
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 0.9em;
        font-weight: bold;
        margin-right: 5px;
        margin-bottom: 5px;
      }

      .synopsis {
        line-height: 1.7;
        text-align: justify;
        margin-bottom: 20px;
        color: var(--light-slate);
      }

      #chapter-list {
        max-height: 620px;
        overflow-y: auto;
        border: 1px solid var(--lightest-navy);
        border-radius: 5px;
        padding: 5px;
      }

      #chapter-list::-webkit-scrollbar {
        width: 8px;
      }
      #chapter-list::-webkit-scrollbar-track {
        background: var(--navy);
      }
      #chapter-list::-webkit-scrollbar-thumb {
        background: var(--slate);
        border-radius: 4px;
      }
      #chapter-list::-webkit-scrollbar-thumb:hover {
        background: var(--light-slate);
      }

      .chapter-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 10px;
        border-radius: 4px;
        transition: background-color 0.3s ease;
      }

      .chapter-item:not(:last-child) {
        border-bottom: 1px solid var(--light-navy);
      }
      .chapter-item:hover {
        background-color: var(--light-navy);
      }

      .chapter-item a {
        color: var(--accent);
        text-decoration: none;
        font-weight: bold;
      }

      .chapter-item a:hover {
        text-decoration: underline;
      }

      .chapter-date {
        font-size: 0.9em;
        color: var(--slate);
      }

      .comment-container {
        max-width: 1200px;
        margin: 25px auto;
        padding: 25px;
        background: var(--navy);
        box-shadow: 0 10px 30px -15px rgba(2, 12, 27, 0.7);
        border-radius: 8px;
      }

      .comment-form textarea {
        width: 100%;
        min-height: 80px;
        padding: 10px;
        margin-bottom: 10px;
        background-color: var(--light-navy);
        border: 1px solid var(--lightest-navy);
        border-radius: 4px;
        color: var(--lightest-slate);
        font-size: 1em;
        resize: vertical;
      }

      .comment-form textarea:focus {
        outline: none;
        border-color: var(--accent);
      }

      .comment-form input[type="text"] {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        background-color: var(--light-navy);
        border: 1px solid var(--lightest-navy);
        border-radius: 4px;
        color: var(--lightest-slate);
        font-size: 1em;
      }
      .comment-form button {
        padding: 10px 20px;
        background-color: var(--accent);
        color: var(--dark-navy);
        border: none;
        border-radius: 4px;
        font-size: 1em;
        font-weight: bold;
        cursor: pointer;
        transition: opacity 0.3s ease;
      }

      .comment-form button:hover {
        opacity: 0.8;
      }

      #comment-list {
        margin-top: 30px;
        max-height: 400px;
        overflow: auto;
      }

      #comment-list::-webkit-scrollbar {
        width: 8px;
      }
      #comment-list::-webkit-scrollbar-track {
        background: var(--navy);
      }
      #comment-list::-webkit-scrollbar-thumb {
        background: var(--slate);
        border-radius: 4px;
      }
      #comment-list::-webkit-scrollbar-thumb:hover {
        background: var(--light-slate);
      }

      .comment-item {
        padding: 15px 0;
        border: 1px solid var(--lightest-navy);
        margin: 20px 0px;
        border-radius: 5px;
      }

      .comment-item:not(:last-child) {
        border-bottom: 1px solid var(--lightest-navy);
      }

      .comment-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 8px;
      }

      .comment-author {
        margin-left: 20px ;
        font-weight: bold;
        color: var(--white);
      }

      .comment-date {
        font-size: 0.8em;
        color: var(--slate);
      }

      .comment-text {
        margin: 0 20px;
        line-height: 1.6;
        color: var(--light-slate);
      }
    </style>
  </head>
  <body>
    <header>
      <a href="../"
        ><i
          ><h1 class="judul">Mona<span>Komik</span></h1></i
        ></a
      >
      <!-- Desktop Navigation -->
      <div class="nav">
        <a href="../" class="home"><p>Home</p></a>
        <a href="manga-list.html"><p>Pustaka</p></a>
        <a href="login.html"><p>Masuk</p></a>
        <a href="register.html"><p>Daftar</p></a>
        <a href="tentang.html"><p>Tentang</p></a>
      </div>

      <button class="mobile-menu-toggle" id="mobileMenuToggle">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <!-- Search Bar -->

      <div class="cari">
        <a onclick="cariKomik()" class="theme" id="theme"
          ><img src="../icon/light-mode.png" alt="Search"
        /></a>

        <span class="material-symbols-outlined light_mode"></span>

        <input type="text" placeholder="search" id="searchInput" />

        <a onclick="cariKomik()"
          ><img src="../assets/search.png" alt="Search"
        /></a>
      </div>
    </header>

    <main>
      <div class="main-container">
        <!-- <aside>

        </aside> -->
      </div>

      <div class="comment-container">

        <h2>Komentar</h2>
        <form class="comment-form" method="post">
          <input
            type="text"
            placeholder="Masukkan Nama"
            id="name"
            required
          />
          <textarea
            placeholder="Tulis komentar Anda di sini..." id="comment"
            required
          ></textarea>
          <button type="submit" id="submitComment">Kirim</button>
        </form>



          <div class="comment-item">
            <div class="comment-header">
              <span class="comment-author">Rudi Setiawan</span>
              <span class="comment-date">19 Juli 2025</span>
            </div>
            <p class="comment-text">
              Ada yang tau komik lain yang mirip-mirip kaya gini?
            </p>
          </div>
        </div>
      </div>

      <div class="smiliar-comic">
        <h2>Komik Serupa</h2>
        <div id="smiliar-comic-list"></div>
      </div>
    </main>

    <footer>
      <div class="medsos">
        <a href="https://instagram.com/yudis.ashura" target="_blank"
          ><span><img src="../icon/instagram.png" alt="" /></span
        ></a>
      </div>
      <div class="medsos">
        <a href="https://github.com/yuuashura" target="_blank"
          ><span><img src="../icon/github.png" alt="" /></span
        ></a>
      </div>
      <div class="medsos">
        <a href="https://facebook.com/4sa.cyber" target="_blank"
          ><span><img src="../icon/facebook.png" alt="" /></span
        ></a>
      </div>
      <div class="medsos">
        <a href="https://telegram.com/#" target="_blank"
          ><span><img src="../icon/telegram.png" alt="" /></span
        ></a>
      </div>

      <div class="text-footer">
        <p>
          All the comics on this website are only previews of the original
          comics,there may be many language errors, character names, and story
          lines. For the original version, please buy the comic if it's
          available in your city.
        </p>
        <br />
        <hr />
        <p>&copy; MoonKomik</p>
      </div>
    </footer>

    <script>
      const params = window.location.search.substring(1);
      const baseApi = "https://yuuashura-api.vercel.app";
      const apiComment = "https://komentar2.vercel.app/api/komentar";
      const komikData = {};
      const mainCOntainer = document.querySelector(".main-container");
      const aside = document.querySelector("aside");
      const header = document.querySelector("header");
      const containerSearch = document.querySelector(".cari");
      const theme = document.querySelector("#theme");
      const comment = document.querySelector("#comment");
    const name = document.querySelector("#name");
    const submitComment = document.querySelector("#submitComment");
    

      async function getData() {
          mainCOntainer.appendChild(createLoader());
        try {
          
          const response = await fetch(`${baseApi}${params}`);
          const data = await response.json();
          komikData.thumbnail = data.thumbnail;
          komikData.info = data.info;
          komikData.alternativeTitle = data.alternativeTitle;
          komikData.sinopsis = data.sinopsis;
          komikData.genres = data.genres;
          komikData.chapters = data.chapters;
          komikData.title = data.title;
          mainCOntainer.removeChild(document.querySelector(".loader"));
          leftData();
          rightData();
        } catch (error) {
          console.log("error response", error);
        }
      }

      window.addEventListener("scroll", function () {
        if (window.scrollY > 50) {
          header.classList.add("scrolled");
          containerSearch.classList.add("cariScroll");
        } else {
          header.classList.remove("scrolled");
          containerSearch.classList.remove("cariScroll");
        }
      });

      function leftData() {
        //left column
        const leftColumn = document.createElement("div");
        leftColumn.className = "left-column";
        const thumb = document.createElement("img");
        thumb.className = "thumbnail";
        thumb.src = komikData.thumbnail;
        thumb.alt = komikData.title;
        const infoTitle = document.createElement("h2");
        infoTitle.textContent = "Informasi Komik";
        const infoContainer = document.createElement("div");
        infoContainer.className = "info-details-container";
        infoContainer.id = "info-details";

        mainCOntainer.appendChild(leftColumn);
        leftColumn.appendChild(thumb);
        leftColumn.appendChild(infoTitle);
        leftColumn.appendChild(infoContainer);
        for (const key in komikData.info) {
          const infoItem = document.createElement("div");
          infoItem.className = "info-item";
          const label = document.createElement("span");
          label.className = "label";
          label.textContent = key;
          const value = document.createElement("span");
          value.className = "value";
          value.textContent = komikData.info[key];
          infoItem.appendChild(label);
          infoItem.appendChild(value);
          infoContainer.appendChild(infoItem);
        }
      }

      function rightData() {
        // Kolom Kanan
        const rightCulumn = document.createElement("div");
        rightCulumn.className = "right-column";
        const title = document.createElement("h1");
        title.id = "title";
        title.textContent = komikData.title;
        const alternativeTittle = document.createElement("h3");
        alternativeTittle.id = "alternative-title";
        alternativeTittle.textContent = komikData.alternativeTitle;
        const genresContainer = document.createElement("div");
        genresContainer.className = "genres";
        genresContainer.id = "genres";
        const synopsisTitle = document.createElement("h2");
        synopsisTitle.textContent = "Sinopsis";
        const synopsis = document.createElement("p");
        synopsis.id = "synopsis";
        synopsis.className = "synopsis";
        synopsis.textContent = komikData.sinopsis;
        const chapterTitle = document.createElement("h2");
        chapterTitle.textContent = "Daftar Chapter";
        const chapterList = document.createElement("div");
        chapterList.id = "chapter-list";

        // MEMASUKKAN SEMUA DATA
        mainCOntainer.appendChild(rightCulumn);
        rightCulumn.appendChild(title);
        rightCulumn.appendChild(alternativeTittle);
        rightCulumn.appendChild(genresContainer);
        rightCulumn.appendChild(synopsisTitle);
        rightCulumn.appendChild(synopsis);
        rightCulumn.appendChild(chapterTitle);
        rightCulumn.appendChild(chapterList);

        // print genre
        komikData.genres.forEach((genre) => {
          const span = document.createElement("span");
          span.className = "genre-tag";
          span.textContent = genre;
          genresContainer.appendChild(span);
        });

        //SEMUA CHAPTER
        komikData.chapters.forEach((chapter) => {
          const chapterDiv = document.createElement("div");
          chapterDiv.className = "chapter-item";
          const chapterLink = document.createElement("a");
          chapterLink.href = chapter.originalLink;
          chapterLink.textContent = chapter.title;
          chapterLink.target = "_blank";
          const chapterDate = document.createElement("span");
          chapterDate.className = "chapter-date";
          chapterDate.textContent = chapter.date;
          chapterDiv.appendChild(chapterLink);
          chapterDiv.appendChild(chapterDate);
          chapterList.appendChild(chapterDiv);
        });
      }



  function createLoader() {
    const loader = document.createElement("div");
    loader.className = "loader";
    return loader;
}









      document.querySelector('.comment-form').addEventListener('submit', async (e) =>{
        e.preventDefault();
        const data = {
            email : name.value,
            komentar : comment.value
        };
        console.log(data);
        
        try{
        const res = await fetch(apiComment, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        if (!res.ok) {
          throw new Error("Gagal mengirim komentar.");
        }else{
            console.log("sukses");
            
        }
        }catch(err){
            console.log(err);
        }

      })


      document.addEventListener("DOMContentLoaded", () => {
        getData();
      });
    </script>
  </body>
</html>
